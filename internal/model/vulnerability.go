package model

import "github.com/uptrace/bun"

type Vulnerability struct {
	bun.BaseModel `bun:"table:vulnerability,alias:v"`
	ID            int64         `json:"id" bun:"id,pk,autoincrement"`
	CVE           string        `json:"cve"`
	Packages      []string      `json:"package"`
	Criteria      []Criteria    `json:"criteria"`
	CVSS          []CVSS        `json:"cvss"`
	Remediations  []Remediation `json:"remediation"`
	References    []Reference   `json:"references"`
	Descriptions  []Description `json:"descriptions"`
}

type Criteria struct {
	CPES          []string `json:"cpes"`
	Constraints   []string `json:"constraint"`
	Source        string   `json:"source"`
	VersionFormat string   `json:"version_format"`
	Scope         string   `json:"scope"`
}

type CVSS struct {
	Method   string  `json:"method"`
	Severity string  `json:"severity"`
	Score    float64 `json:"score"`
	Vector   string  `json:"vector"`
}

type Remediation struct {
	Source string `json:"source"`
	State  string `json:"state"`
	Fix    string `json:"fix"`
	Scope  string `json:"scope"`
}

type Reference struct {
	Source string `json:"source"`
	URL    string `json:"url"`
}

type Description struct {
	Source  string `json:"source"`
	URL     string `json:"url"`
	Content string `json:"content"`
}

package model

import "github.com/uptrace/bun"

type Vulnerability struct {
	bun.BaseModel `bun:"table:vulnerability,alias:v"`
	ID            int64       `json:"id" bun:"id,pk,autoincrement"`
	CVE           string      `json:"cve,omitempty"`
	Package       string      `json:"package,omitempty"`
	Criteria      Criteria    `json:"criteria,omitempty"`
	CVSS          CVSS        `json:"cvss,omitempty"`
	Remediation   Remediation `json:"remediation,omitempty"`
	Reference     Reference   `json:"references,omitempty"`
	Description   Description `json:"descriptions,omitempty"`
}

type Criteria struct {
	CPES          []string `json:"cpes,omitempty"`
	Constraint    string   `json:"constraint,omitempty"`
	Source        string   `json:"source,omitempty"`
	VersionFormat string   `json:"version_format,omitempty"`
	Scope         string   `json:"scope,omitempty"`
}

type CVSS struct {
	Method   string  `json:"method,omitempty"`
	Severity string  `json:"severity,omitempty"`
	Score    float64 `json:"score,omitempty"`
	Vector   string  `json:"vector,omitempty"`
}

type Remediation struct {
	Source string `json:"source,omitempty"`
	State  string `json:"state,omitempty"`
	Fix    string `json:"fix,omitempty"`
	Scope  string `json:"scope,omitempty"`
}

type Reference struct {
	Source string `json:"source,omitempty"`
	URL    string `json:"url,omitempty"`
}

type Description struct {
	Source  string `json:"source,omitempty"`
	URL     string `json:"url,omitempty"`
	Content string `json:"content,omitempty"`
}
